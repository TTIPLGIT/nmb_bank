// For license information, see `https://assets.adobedtm.com/5ef092d1efb5/2537c33769cb/459fd267420b/RC6e3e8b1d782343b1bb26a19a4cb6309f-source.js`.
_satellite.__registerScript('https://assets.adobedtm.com/5ef092d1efb5/2537c33769cb/459fd267420b/RC6e3e8b1d782343b1bb26a19a4cb6309f-source.min.js', "var eventTagging;window.oa=window.oa||{},window.oa.tagging=window.oa.tagging||{data:{},setup:{complete:{}},factory:{}},window.oa.tagging.utfv=\"972d797ce0b44da215c18a21afe54745d27e7082\",function(){function r(e){return e in t?t[e]:e}var o=window.oa.tagging.factory,t={critical:10,error:20,warn:30,info:40};o.handler=function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);this._utfversion=\"2018-06-27 16:14:51\",this.name=e,this.handleMethod=t,this.logLevel=n},o.handler.prototype={},o.handlerBlock=function n(){if(!(this instanceof n))return new n;this._utfversion=\"2018-06-27 16:14:51\",this.newHandler=!1,this.handlers=[],this.organizedHandlers={},this.logLevels=t},o.handlerBlock.prototype={add:function a(e,t,n){this.newHandler=!0,n=r(n),this.handlers.push(o.handler(e,t,n)),this._cullHandlers(n)},remove:function s(e){for(var t=0;t<this.handlers.length;t++)this.handlers[t].name===e&&this.handlers.splice(t,1)},handle:function(e){for(var t=this._retrieveHandlers(e.logLevel),n=0;n<t.length;n++){t[n].handleMethod(e)}},_retrieveHandlers:function(e){return e in this.organizedHandlers||this._generateOrganizedHandlers(e),this.organizedHandlers[e]},_generateOrganizedHandlers:function(e){for(var t=[],n=0;n<this.handlers.length;n++){var i=this.handlers[n];i.logLevel>=e&&t.push(i)}this.organizedHandlers[e]=t},_cullHandlers:function(e){for(var t={},n=0;n<this.organizedHandlers.length;n++)e<n&&(t[n]=this.organizedHandlers[n]);this.organizedHandlers=t}},o.logRecord=function u(e,t,n){if(!(this instanceof u))return new u(e,t,n);this._utfversion=\"2018-06-27 16:14:51\",this.logLevel=e,this.extensionName=t,this.message=n;var i=new Date;this.timestamp=(\"0\"+i.getHours()).slice(-2)+\":\"+(\"0\"+i.getMinutes()).slice(-2)+\":\"+(\"0\"+i.getSeconds()).slice(-2)+\":\"+(\"00\"+i.getMilliseconds()).slice(-3)+\"T\"+i.getFullYear()+(\"0\"+(i.getMonth()+1)).slice(-2)+(\"0\"+i.getDate()).slice(-2)},o.sherlock=function l(e){if(!(this instanceof l))return new l(e);this._utfversion=\"2018-06-27 16:14:51\",this.records=e},o.sherlock.prototype={getExactLevel:function(e){var t=[];e=r(e);for(var n=0;n<this.records.length;n++)this.records[n].logLevel===e&&t.push(this.records[n]);return t},getAboveOrEqualLevel:function(e){var t=[];e=r(e);for(var n=0;n<this.records.length;n++)this.records[n].logLevel>=e&&t.push(this.records[n]);return t},getBelowOrEqualLevel:function(e){var t=[];e=r(e);for(var n=0;n<this.records.length;n++)this.records[n].logLevel<=e&&t.push(this.records[n]);return t},getExtensionAndExactLevel:function(e,t){var n=[];t=r(t);for(var i=0;i<this.records.length;i++)this.records[i].extensionName===e&&this.records[i].logLevel===t&&n.push(this.records[i]);return n},getExtension:function(e){for(var t=[],n=0;n<this.records.length;n++)this.records[n].extensionName===e&&t.push(this.records[n]);return t}},o.logger=function c(){if(!(this instanceof c))return new c;this._utfversion=\"2018-06-27 16:14:51\",this.records=[],this.handlers=o.handlerBlock(),this.logLevels=t,this.sherlock=o.sherlock(this.records),this.portable=function n(e,t){this.info(e,t)},this.portable.info=this.info,this.portable.warn=this.warn,this.portable.error=this.error,this.portable.critical=this.critical},o.logger.prototype={handle:function(e,t,n){n=r(n);var i=o.logRecord(n,e,t);this.handlers.handle(i),this.records.push(i)},info:function(e,t){this.handle(e,t,\"info\")},warn:function(e,t){this.handle(e,t,\"warn\")},error:function(e,t){this.handle(e,t,\"error\")},critical:function(e,t){this.handle(e,t,\"critical\")},addHandler:function(e,t,n){this.handlers.add(e,t,n)},removeHandler:function(e){this.handlers.remove(e)},_clearLogs:function(){this.records=[]}};var e=o.logger();e.addHandler(\"console\",function(e){window.oa.tagging.data.store.get(\"isDebug\")&&(e.message instanceof Error&&e.message.stack&&e.message?console.log(e.logLevel+\" \"+e.message.stack):console.log(e.logLevel+\" \"+e.message))},\"error\"),window.oa.tagging.logger=e}(),(eventTagging=window.oa?window.oa.tagging:{}).eventDriver=function(){function e(){\"use strict\";function i(t,n){document.addEventListener?document.addEventListener(t,n,!1):document.documentElement.attachEvent(\"onpropertychange\",function(e){e.propertyName===t&&n(t)})}function e(e,t){function n(e){var t=\"\",n=null;e instanceof Event?(t=e.type,e.detail&&(n=e.detail)):t=e;for(var i=s[t],r=i.length,o=0;o<r;o++)window.oa.tagging.eventDriver.oaPromise(function(){i[o](n,t)})}return s[e]||(s[e]=[],i(e,n)),s[e].push(t),s[e].fired&&window.oa.tagging.eventDriver.oaPromise(t(s[e].data,s[e].eventName)),!0}function t(e,t){var n;t=null==t?[e]:((n=[t]).push(e),n);try{var i=new CustomEvent(e,{detail:t});document.dispatchEvent(i)}catch(r){(i=document.createEvent(\"Event\")).initEvent(e,!0,!0),document.dispatchEvent(i)}s[e]||(s[e]=[]),s[e].fired=!0,s[e].data=t,s[e].eventName=e}function u(t,n,i,r,o,a){var s=a||1;return n().then(function(e){i(e)},function(e){if(o!==undefined&&o(e,s,t),!(t<=s))return u(t,n,i,r,o,a=s+1);r(e)})}function r(e,t,n){for(var i=n===undefined?undefined:n,r=0;r<e.length;r++)i=i!==undefined?t.call(undefined,i,e[r],r,this):e[r];return i}function a(e,t,n){for(var i,r=0,o=n||this;i=e[r++];)t.call(o,i,r)}function n(e){var n=[];r(e,function(e,t){e.then(function(){return t}).then(function(e){n.push(e)})},new o(function(e){e(null)}))}var s={},o=function(){function l(e){return\"function\"==typeof e}function s(e){return e&&e.constructor===g}function u(e){return null!==e&&\"object\"==typeof e}function c(t,n,i){setTimeout(function(){try{t(n)}catch(e){i(e)}},1)}function g(e){var n=this;if(!(this instanceof g)){var t=new g,i=g.apply(t,arguments);return i===undefined?t:i}this.state=1,this.value=undefined,this.handlers={onFulfilled:[],onRejected:[]},this.handlerCalled={onFulfilled:!1,onRejected:!1},this._listeners=[],this._utfversion=\"2017-09-21 02:38:28\",this.resolve=function r(e){n.fulfill(e)},this.fulfill=function o(e){if(1===n.state||!0!==n.handlerCalled.onFulfilled&&!0!==n.handlerCalled.onRejected){if(n.state=2,n.value=e,n.handlerCalled.onFulfilled=!0,0<n.handlers.onFulfilled.length)for(;0!==n.handlers.onFulfilled.length;){c(n.handlers.onFulfilled.shift(),n.value,n.reject)}return n._fireListeners(),n}},this.reject=function a(e){if(1===n.state||!0!==n.handlerCalled.onRejected&&!0!==n.handlerCalled.onFulfilled){if(n.state=3,n.value=e,n.handlerCalled.onRejected=!0,0<n.handlers.onRejected.length)for(;0!==n.handlers.onRejected.length;){c(n.handlers.onRejected.shift(),n.value,n.reject)}return n._fireListeners(),n}},this._fireListeners=function s(){if(1!==n.state)for(var e=n._listeners.length;0<=--e;){var i=n._listeners[e];c(function(e){var t=0,n=e[1];2===e[0]?t=\"resolve\":3===e[0]&&(t=\"reject\"),\"fired\"!==i.status&&(i[t](n),i.status=\"fired\")},[n.state,n.value],n.reject)}},this.listen=function u(e,t){n._listeners.push({resolve:e,reject:t,status:\"unfired\"}),n._fireListeners()},l(e)&&e(function(e){n.resolution(n,e)},function(e){n.reject(e)})}return g.Resolve=function(e){return(new g).fulfill(e)},g.Reject=function(e){return(new g).reject(e)},g.prototype={resolution:function d(t,e){if(t===e)t.reject(\"type error\");else if(s(e))1===e.state?e.then(function(e){t.resolve(t,e)},function(){t.reject(reject)}):2===e.state?t.fulfill(e.value):3===e.state&&t.reject(e.value);else if(u(e)||l(e)){var n,i=!0;try{n=e.then}catch(r){t.reject(r)}if(l(n))try{n.call(e,function o(e){i&&(i=!1,t.resolution(t,e))},function a(e){i&&(i=!1,t.reject(e))})}catch(r){i&&t.reject(r)}else t.fulfill(e)}else t.fulfill(e)},wrappedlisten:function(e,t){return this._listeners.push({resolve:e,reject:t,status:\"unfired\"}),\"completed\"===this._status&&this._fireListeners(this._resultType,this._result),this},then:function n(i,r){r=\"function\"==typeof r?r:function(e){throw e},l(i=\"function\"==typeof i?i:function(e){return e})||(i=null),l(r)||(r=null);var o=new g;if(this.handlers.onFulfilled.push(function a(e){try{var t=i(e);o.resolution(o,t)}catch(n){o.reject(n)}}),this.handlers.onRejected.push(function s(e){try{var t=r(e);o.resolution(o,t)}catch(n){o.reject(n)}}),l(i)||2!==this.state||o.resolve(this.value),l(r)||3!==this.state||o.reject(this.value),l(i)&&2===this.state)try{c(function(){var e=i(t);o.resolution(o,e)},t=this.value,o.reject)}catch(e){o.reject(e)}if(l(r)&&3===this.state)try{var t;c(function(){var e=r(t);o.resolution(o,e)},t=this.value,o.reject)}catch(e){o.reject(e)}return o},_fireListeners:function(e,t){for(var n,i=0;n=this._listeners[i++];)\"fired\"!==n.status&&(n[e]&&n[e](t),this._listeners[i-1].status=\"fired\")}},g.All=function(e){return new g(function(n,i){var r=new Array(e.length);0===e.length&&n.call(this,e);var o=e.length;a(e,function(e,t){e.then(function(e){r[t-1]=e,0===(o-=1)&&n.call(this,r)},function(e){i.call(this,e)})},this)})},g.ListenAll=function(e){return new g(function(n,i){var r=new Array(e.length);0===e.length&&n.call(this,e);var o=e.length;a(e,function(e,t){e.listen(function(e){r[t-1]=e,0===(o-=1)&&n.call(this,r)},function(e){i.call(this,e)})},this)})},g.deferred=function t(){var e=new g;return{promise:e,resolve:e.resolve,reject:e.reject}},g}();return{listen:i,trigger:t,listenGroup:e,oaReduce:r,oaForEach:a,oaPromiseAll:n,oaPromise:o,oaRetryUntilResolve:u,utfVersion:l}}var l=\"2018-09-13 18:10:48\";return e()}(),oaTagging=window.oa.tagging,util=oaTagging.util||{},util._utfversion=\"2018-09-26 17:07:25\",util.toObject=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=e[n];return t},util.getVersion=function(){return(window.utag&&window.utag.id?window.utag.id.split(\".\")[1]:window._satellite&&window._satellite.property?window._satellite.property.name:\"Unknown\")+\"|\"+(window.oa.tagging.dn?window.oa.tagging.dn:\"Unknown\")+\"|\"+(window.oa.tagging.dv?window.oa.tagging.dv:\"Unknown\")+\"|\"+(window.oa.tagging.utfv?window.oa.tagging.utfv:\"Unknown\")},util.isJSLLElement=function(e){return/(^a$|button|img|input)/i.test(e)},util.getCookie=function(e){for(var t=e+\"=\",n=document.cookie.split(\";\"),i=0;i<n.length;i++){for(var r=n[i];\" \"===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},util.createCookie=function(e,t,n){var i;if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3),i=\"; expires=\"+r.toGMTString()}else i=\"\";document.cookie=e+\"=\"+t+i+\"; path=/\"},util.deleteCookie=function(e){window.oa.tagging.util.createCookie(e,\"\",-1)},util.debugOn=function(){window.oa.tagging.util.createCookie(\"cfDebug\",\"true\",8)},util.debugOff=function(){window.oa.tagging.util.deleteCookie(\"cfDebug\")},util.setMetaTags=function(e){for(var t,n,i=0;i<e.length;i++)if(t=e[i].split(\"::\"),n=document.querySelector(\"meta[name='\"+t[0]+\"']\"))n.getAttribute(\"content\")!==t[1]&&n.setAttribute(\"content\",t[1]);else{var r=document.createElement(\"meta\");r.name=t[0],r.content=t[1],document.getElementsByTagName(\"head\")[0].appendChild(r)}},util.setJSLLMeta=function(e){var t,n=[];for(var i in e)\"\"===(t=e[i])?window.oa.tagging.logger.info(\"JSLL\",\"settingMeta tag key: awa-\"+i+\" value is empty\"):(window.oa.tagging.logger.info(\"JSLL\",\"settingMeta tag key: awa-\"+i+\" value is \"+t),n.push(\"awa-\"+i+\"::\"+t));return n},util.extend=function(e){for(var t=e||{},n=1,i=arguments.length;n<i;n++)if(arguments[n])for(var r in arguments[n])arguments[n].hasOwnProperty(r)&&(t[r]=arguments[n][r]);return t},util.replaceValue=function(e,t,n){return e.split(new RegExp(t,\"gi\")).join(n)},util.build={img:function(e){var t=e;window.oa.tagging.logger.info(\"util.build.img\",\"tagObj is: \"+JSON.stringify(t));var n,i=t.url,r=new RegExp(/(%RAND%)/i),o=new RegExp(/(%ID%)/gi),a=(new RegExp(/(%.*%)/gi),Math.round(Date.now()*Math.random()).toString()),s=(n=location.search,window.oa.tagging.data.store&&window.oa.tagging.data.store.get(\"isDebug\")?window.oa.tagging.data.store.get(\"isDebug\"):-1!==n.indexOf(\"blueprint=1\"));if(t.id!==undefined&&null!==i.match(o)&&(i=i.replace(o,encodeURIComponent(t.id))),t!==undefined&&\"object\"==typeof t)for(var u in t)if(\"bustcache\"!==u&&\"url\"!==u&&\"id\"!==u)if(Boolean(t[u])&&t[u].encode!==undefined&&!t[u].encode)i=window.oa.tagging.util.replaceValue(i,\"%\"+u+\"%\",t[u].val);else{var l=t[u];null!==t[u]&&t[u].val!==undefined&&(l=t[u].val),i=window.oa.tagging.util.replaceValue(i,\"%\"+u+\"%\",encodeURIComponent(l))}if(!0===t.bustcache&&(null!==i.match(r)?i=i.replace(r,encodeURIComponent(a)):i+=encodeURIComponent(a)),s){var c=document.createElement(\"a\");c.setAttribute(\"href\",\"https://www.campfireanalytics.com/testPixel/?requestUrl=%newUrl%\"),c.search=window.oa.tagging.util.replaceValue(c.search,\"%newUrl%\",i),(new Image).src=c.href}else(new Image).src=i,window.oa.tagging.logger.info(\"util.build.img\",\"Pixel fired with src: \"+i);return i||!1},script:function(e){var t=e;window.oa.tagging.logger.info(\"util.build.script\",\"tagObj is: \"+JSON.stringify(t));var n=document.createElement(\"script\");return n.type=\"text/javascript\",n.src=t.src,t.id&&(n.id=t.id),document.getElementsByTagName(\"head\")[0].appendChild(n),n.onload=e.callback,n.onreadystatechange=function(){\"complete\"===this.readyState&&(window.oa.tagging.logger.info(\"util.build.script\",\"Building script with src: \"+e.src),e.callback())},!!t.src&&t.src},iframe:function(e){var t=e;window.oa.tagging.logger.info(\"util.build.iframe\",\"tagObj is: \"+JSON.stringify(t));var n=document.createElement(\"iframe\");return n.src=t.url,n.style.display=\"none\",t.id!==undefined&&(n.id=t.id),t.returnIframe!==undefined&&!0===t.returnIframe?(window.oa.tagging.logger.info(\"util.build.iframe\",\"Returning iframe with src: \"+t.src),n):(window.oa.tagging.logger.info(\"util.build.iframe\",\"Building iframe with src: \"+t.src),document.body.appendChild(n),!!t.src&&t.src)}},util.dlValsToString=function(e,t,n){for(var i=arguments,r=n,o=\"\",a=n!==undefined?3:2;a<i.length;a++)o=o+(r[i[a]]!==undefined&&0!==r[i[a]].length?r[i[a]]:t)+(a<i.length-1?e:\"\");return o},util.findNearestElement=function(e,t){return null!==t&&t.nodeName===e?t:(null===t||\"BODY\"!==t.nodeName)&&this.findNearestElement(e,t.parentNode)},util.matchfwlink=function(e,t){for(var n=[],i=Object.keys(e),r=0;r<i.length;r++)e[i[r]].fwlink_id===t&&n.push(i[r]);return n},util.getQueryParam=function(e,t){var n=window.oa.tagging.data.store.get(\"jquery\");t=t||location.search,e=e.replace(/[\\[]/,\"\\\\[\").replace(/[\\]]/,\"\\\\]\");var i=new RegExp(\"[\\\\?&]\"+e+\"=([^&#]*)\").exec(t);return n.trim(null===i?\"\":decodeURIComponent(i[1].replace(/\\+/g,\" \")))},util.guidToBytes=function(e){for(var t=[],n=e.split(\"-\"),i=0;i<n.length;i++)for(var r=i<3?n[i].match(/.{1,2}/g).reverse():n[i].match(/.{1,2}/g),o=0;o<r.length;o++)t.push(parseInt(r[o],16));return t},util.encodeASCII85=function(e){for(var t=new Array(5),n=new Array(4),i=[],r=0,o=0,a=0;a<e.length;a++){var s=e[a];if(r>=n.length-1)(o|=s)<0&&(o>>>=0),0===o?i.push(\"z\"):window.oa.tagging.util.encodeBlock(t.length,i,t,o,33),r=o=0;else{o|=s<<24-8*r>>>0,o>>>=0,r++}}return 0<r&&window.oa.tagging.util.encodeBlock(r+1,i,t,o,33),i.join(\"\")},util.encodeBlock=function(e,t,n,i,r){for(var o=n.length-1;0<=o;o--)n[o]=i%85+r,i/=85;for(o=0;o<e;o++){var a=String.fromCharCode(n[o]);t.push(a)}},util.waitUntilPromise=function(e,t,n,i){function r(){e()?t.resolve(!0):i<=o?t.reject(!1):(o+=n,setTimeout(r,n))}var o=0;n===undefined&&(n=500),i===undefined&&(i=3e3),r()},util.waitUntil=function(e,t,n,i){function r(){if(e())t(!0);else{if(i<=o)return t(!1),!1;o+=n,setTimeout(r,n)}}var o=0;n===undefined&&(n=500),i===undefined&&(i=3e3),r()},util.delay=function(e,t){setTimeout(t,e)},util.jQuery=function(){function t(e){if(!(this instanceof t))return obj=new t,ret=t.apply(obj,arguments),ret===undefined?obj:ret;this._element=e&&e.nodeType?e:document.querySelector(e),this.length=null!==this._element?1:0,this._utfversion=\"\"}function n(e,t){return e._element.querySelectorAll(t)}function i(e,t){return Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),e._element.closest(t)}function r(e,t,n,i){if(\"function\"==typeof n&&(i=n,n=undefined),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),!e)return null;e.addEventListener?e.addEventListener(t,function(e){var t=e.target;n&&t.matches(n)&&i.call(e),n||i.call(e)}):e.attachEvent(\"on\"+t,function(e){var t=e.target;n&&t.matches(n)&&i.call(e)})}return t.ajax=function(t){var e=new XMLHttpRequest;e.open(t.type,t.url,!0),e.onreadystatechange=function(){if(4===this.readyState)if(200<=this.status&&this.status<400){var e=this.responseText;t.success(JSON.parse(e))}else t.error()},e.send(),e=null},t.inArray=function(e,t){if(t&&this.isArray(t)&&e)for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},t.trim=function(e){return e.replace(/^\\s+|\\s+$/g,\"\")},t.isArray=function(e){return\"[object Array]\"===toString.call(e)},t.prototype={find:function(e){return n(this,e)},closest:function(e){return i(this,e)},ready:function(e){\"loading\"!==document.readyState?e():document.addEventListener?document.addEventListener(\"DOMContentLoaded\",e):document.attachEvent(\"onreadystatechange\",function(){\"loading\"!==document.readyState&&e()})},on:function(e,t,n){return r(this._element,e,t,n)},hide:function(){null!==this._element&&(this._element.style.display=\"none\")},attr:function(e,t){return null!==this._element?t===undefined?null!==this._element.getAttribute(e)?this._element.getAttribute(e):undefined:\"\"===t?this._element.setAttribute(e,\"\"):this._element.setAttribute(e,t):undefined}},t}(),util.bind=function(e,t){if(\"function\"!=typeof e)throw new TypeError(\"Function.prototype.bind - what is trying to be bound is not callable\");var n=Array.prototype.slice.call(arguments,2),i=function(){},r=function(){return e.apply(this instanceof i?this:t,n.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(i.prototype=this.prototype),r.prototype=new i,r},util.isRedTiger=function isRedTiger(){if(null!==document.querySelector(\"body[class*='p_']\"))for(var e=document.querySelectorAll(\"script\"),t=0;t<e.length;t++)if(-1!==e[t].src.indexOf(\"onerfstatics\"))return!0;return!1},window.oa.tagging.util=util,window.oa.tagging.createDataStore=function(e,t){function n(e,t){if(!(this instanceof n))return obj=new n,ret=n.apply(obj,arguments),ret===undefined?obj:ret;this._registers={},this._taggingContainer=e,this._logger=t,this._utfversion=\"2017-11-21 00:19:58\",this._options={}}function o(e,t,n,i,r){if(!(this instanceof o))return obj=new o,ret=o.apply(obj,arguments),ret===undefined?obj:ret;this.name=e,this._populator=t,this._taggingContainer=n,this._logger=i,this._values=undefined,this._options=this._setOptions(r),this.populated=!1,this.hasException=!1,this._populatorException=undefined,this._utfversion=\"2017-11-21 00:19:58\"}return n.prototype.register=function(e,t,n){if(this._registers[e]!==undefined)return this.populate(e);var i=new o(e,n,this._taggingContainer,this._logger,t);this._options[e]!==undefined&&i.setOptions(this._options[e]),this._registers[e]=i,this[e]=function(){return this.populate(e)}},n.prototype.populate=function(e,t,n){return this._registers[e]?(this._registers[e].populate(),n&&n(),this._registers[e].values):t},n.prototype.get=function(e,t){if(this._registers[e]===undefined)return undefined;var n=t||{};return this._registers[e].get(n)},n.prototype.set=function(e,t,n){if(this._registers[e]===undefined){var i=new o(e,function(e,t){return t},this._taggingContainer,this._logger,n);this._options[e]!==undefined&&i.setOptions(this._options[e]),this._registers[e]=i}return this._registers[e].set(t,n)},n.prototype.setOptions=function(e,t){if(this._registers[e]!==undefined)return this._registers[e].setOptions(t);var n=this._taggingContainer.util.extend;return this._options[e]=n(this._options[e]!==undefined?this._options[e]:{},t),!1},o.prototype._setOptions=function(e){var t=null,n=\"always\";return\"object\"==typeof(e=(0,this._taggingContainer.util.extend)({},e))&&null!==e&&e!==undefined&&(e.hasOwnProperty(\"defaultValue\")&&(t=e.defaultValue),e.hasOwnProperty(\"autoPopSetting\")&&e.autoPopSetting in{once:!0,always:!0,never:!0}&&(n=e.autoPopSetting)),e.defaultValue=t,e.autoPopSetting=n,e},o.prototype.populate=function(e){try{this._values=this._populator(this,this._values,e),this.populated=!0}catch(t){this._values=e.defaultValue,this.hasException=!0,this._populatorException=t}return this._values},o.prototype.get=function(e){var t={},n=!1,i=this._options.defaultValue,r=this._options.autoPopSetting;return\"boolean\"==typeof e?n=e:\"object\"==typeof e&&(e.hasOwnProperty(\"populateFlag\")&&(n=e.populateFlag),e.hasOwnProperty(\"defaultValue\")&&(i=e.defaultValue)),t.populateFlag=n,t.defaultValue=i,t=this._taggingContainer.util.extend(t,this._options),\"once\"===r&&!1===this.populated?this.populate(t):n||\"always\"===r?this.populate(t):this._values},o.prototype.set=function(e){return this.populated=!0,this._values=e,this._values},o.prototype.setOptions=function(e){return this._options=this._setOptions(e),this._values},new n(e,t)},oaTaggingStore=window.oa.tagging.createDataStore(window.oa.tagging,window.oa.tagging.logger),window.oa.tagging.data.store=oaTaggingStore,window.oa.tagging.createSetupProvider=function(e,t){function a(e,t,n,i,r,o){if(!(this instanceof a))return obj=new a,ret=a.apply(obj,arguments),ret===undefined?obj:ret;this.name=e,this.status=\"not ran\",this._filter=n,this._activity=t,this._dataStore=r,this._taggingContainer=i,this.dataStore=function s(r,o,a){var e={get:function(e,t){return o.logger.info(r,\"Getting DataStore Value from \"+e),a.get(e,t)},set:function(e,t,n){o.logger.info(r,\"Setting DataStore Value at \"+e);var i=a.set(e,t,n);return o.logger.info(r,\"Set value is \"+JSON.stringify(i)),i},register:function(e,t,n){o.logger.info(r,\"Registering new Data Store Register \"+e);var i=a.register(e,t,n);return o.logger.info(r,\"Registration Complete with return of \"+JSON.stringify(i)),i}};return e._dataStore=a,e}(this.name,this._taggingContainer,this._dataStore)}function r(e,t){var n,i;if(!(this instanceof r))return n=new r,(i=r.apply(n,arguments))===undefined?n:i;this._tags={},this._setupFunctions={},this._dataStore=t,this._taggingContainer=e,this._utfversion=\"2018-05-22 17:01:48\"}return a.prototype.filter=function(){return this._filter===undefined?function(){return!0}:this._filter(this._taggingContainer,this.dataStore)},a.prototype.isCompleteOrFail=function(){return\"complete\"===this.status||\"failed\"===this.status},a.prototype.execute=function(){return this._activity(this._taggingContainer,this.dataStore)},r.prototype.addTag=function(e,t){(this._tags[e]=t).hasOwnProperty(\"pageload\")},r.prototype.addSetupFunc=function(e,t){this._taggingContainer.logger.info(\"setupProvider\",\"Adding setupStep \"+e+\" to list\");var n=new a(e,t,undefined,this._taggingContainer,this._dataStore);this._setupFunctions[e]=n},r.prototype.start=function(){for(var e in this._setupFunctions)if(this._setupFunctions.hasOwnProperty(e))try{this._taggingContainer.logger.info(\"setupProvider\",\"Tag \"+e+\" started\"),this.runTag(e)}catch(t){this._taggingContainer.logger.error(\"Exception\",\"setupProvider: throwing exception for tag \"+e),this._taggingContainer.logger.error(\"Exception\",\"setupProvider: \"+t)}},r.prototype.runTag=function(e){try{return!!this._setupFunctions[e]&&(this._setupFunctions[e].execute(),this._taggingContainer.logger.info(\"setupProvider\",\"Tag \"+e+\" completed without exception\"),!0)}catch(t){return this._taggingContainer.logger.error(\"setupProvider\",\"Tag \"+e+\" failed with exception\"),this._taggingContainer.logger.error(\"setupProvider\",\"Exception: \"+t),!1}},new r(e,t)},oaSetupProvider=window.oa.tagging.createSetupProvider(window.oa.tagging,window.oa.tagging.data.store),window.oa.tagging.setupProvider=oaSetupProvider,window.oa.tagging.createQueueProvider=function(e,t){\"use strict\";function d(e,t,n,i,r){if(!(this instanceof d)){var o=new d,a=d.apply(o,arguments);return a===undefined?o:a}this.name=e,this.status=\"not ran\",this._utfversion=\"2018-10-11 18:47:25\",this._filter=n,this._activity=t,this._dataStore=r,this._taggingContainer=i,this.update=i.util.bind(function s(e){this._taggingContainer.logger.info(this.name,e)},this),this.update.info=i.util.bind(function s(e){this._taggingContainer.logger.info(this.name,e)},this),this.update.warn=i.util.bind(function u(e){this._taggingContainer.logger.warn(this.name,e)},this),this.update.error=i.util.bind(function l(e){this._taggingContainer.logger.error(this.name,e)},this),this.update.critical=i.util.bind(function c(e){this._taggingContainer.logger.critical(this.name,e)},this),this.dataStore=function g(o,a,s){var e={get:function(e,t){return a.logger.info(o,\"Getting DataStore Value from \"+e),s.get(e,t)},set:function(e,t,n){a.logger.info(o,\"Setting DataStore Value at \"+e);var i=s.set(e,t,n);try{a.logger.info(o,\"Set value is \"+JSON.stringify(i))}catch(r){a.logger.info(o,\"Circular reference. Unable to store value\")}return i},register:function(e,t,n){a.logger.info(o,\"Registering new Data Store Register \"+e);var i=s.register(e,t,n);return a.logger.info(o,\"Registration Complete with return of \"+JSON.stringify(i)),i}};return e._dataStore=s,e}(this.name,this._taggingContainer,this._dataStore)}function n(a,e){var t={_utfversion:\"2018-10-11 18:47:25\",list:{},workingList:[],workingQueue:[]};return t._dataStore=e,t.taggingContainer=a,t._notFinished=undefined,t._counts=undefined,t.errorCount=0,t._maxErrorCount=4,t.getTotalCount=function(){return this._counts.totalCount},t.getWorkingTotal=function(){return this._counts.workingCount},t._increment_TotalCounter=function(){this._counts===undefined&&(this._counts={workingCount:0,totalCount:0}),this._counts.totalCount++},t._increment_WorkingCounter=function(){this._counts===undefined&&(this._counts={workingCount:0,totalCount:0}),this._counts.workingCount++},t._decrement_WorkingCounter=function(){this._notFinished!==undefined&&0!==this._notFinished||(this._notFinished=this._counts.workingCount),this._notFinished--},t._startWorkingCounter=function(){this._notFinished=this._counts.workingCount},t._piecesNotComplete=function(){if(this._notFinished===undefined){var e=0;for(var t in this.list)this.list.hasOwnProperty(t)&&(this.list[t].isCompleteOrFail||e++);this._notFinished=e}return this._notFinished},t._prepareWorkingList=function(){for(var e=this.workingList.length-1;-1<e;e--)this.workingQueue.push(this.workingList[e])},t._processNext=function(){try{var r=this,o=this.workingQueue.pop();return r._decrement_WorkingCounter(),new s(function(t,n){var i=o;u(3,function(){return r._execute(o,t,n)},function(e){(e||e===undefined)&&(r.taggingContainer.logger.info(\"queueProvider\",\"process successful \"+o),r.taggingContainer.logger.info(o,\"process successful \"+o),0,t(i))},function(e){0,r.taggingContainer.logger.error(\"queueProvider\",o+\" Failed with exception:  \"+e),r.taggingContainer.logger.error(\"queueProvider\",e),n(e)},function(e,t,n){r.taggingContainer.logger.error(o,o+\" failed to execute properly. Retried \"+t+\" errors of \"+n),r.taggingContainer.logger.error(o,e)})})}catch(e){this.taggingContainer.logger.error(\"queueProvider\",e),this._decrement_WorkingCounter()}},t._execute=function(n){if(n===undefined)return s.Reject(\"Process name must be given\");var i=this.list[n];if(i===undefined)return this.taggingContainer.logger.warn(\"Process: \"+n+\" does not exist\"),s.Reject(\"Process: \"+n+\" does not exist\");var e;this.taggingContainer.logger.info(n,\"Tag \"+n+\" processing in queue\");try{e=i.filter(this.taggingContainer,this._dataStore);var t=function r(e){var t;return e?t=new s(function(t,n){try{i.execute().then(function(e){t(e)},function(e){n(e)})}catch(e){n(e)}}):(t=s.Resolve(!1),this.taggingContainer.logger.warn(n,\"Tag \"+n+\" failed filter. Skipping\"),t)};t=a.util.bind(t,this),e===undefined||e.then===undefined?e=s.Resolve(e):\"function\"==typeof e&&(e=s.Resolve(e(this.taggingContainer,this._dataStore))),e=e.then(t,function(e){this.taggingContainer.logger.error(\"queueProvider\",\"Filter Action has thrown an exception\"),this.taggingContainer.logger.error(\"queueProvider\",e)})}catch(o){return this.errorCount++,this.taggingContainer.logger.error(\"queueProvider\",\"Process:\"+i.name),this.taggingContainer.logger.error(\"queueProvider\",o),this.taggingContainer.logger.error(n,n+\" failed to execute with error: \"+o),s.Reject(n+\" failed to execute with error: \"+o)}return e},t.addPiece=function(e,t,n,i){this.taggingContainer.logger.info(e,\"Adding Tag \"+e+\" to queue\");var r=new d(e,t,i,this.taggingContainer,this._dataStore);this.list[r.name]=r,n!==undefined&&n.skip||(this.workingList.push(r.name),this._increment_WorkingCounter()),this._increment_TotalCounter()},t.runPiece=function(t){var n=this;this.taggingContainer.logger.info(\"queueProvider\",t+\" being called to run\");var e=n._execute(t);return e.then(function(e){n.taggingContainer.logger.info(\"queueProvider\",t+\" executed with result of \"+e)},function(e){n.taggingContainer.logger.error(\"queueProvider\",t+\" rejected with result of \"+e),n.taggingContainer.logger.error(\"queueProvider\",e)}),e},t.start=function(){this._prepareWorkingList(),this._startWorkingCounter();for(var e=[];0<this._notFinished;)e.push(this._processNext()),0;return s.ListenAll(e)},t}var s=e.eventDriver.oaPromise,u=e.eventDriver.oaRetryUntilResolve;return d.prototype.filter=function(){return this._filter===undefined&&\"function\"!=typeof this._filter||this._filter(this._taggingContainer,this.dataStore,this.update)},d.prototype.isCompleteOrFail=function(){return\"complete\"===this.status||\"failed\"===this.status},d.prototype.execute=function(){var r=this;return new s(function(e,t){try{var n=r._activity(r._taggingContainer,r.dataStore,e,r.update);n!==undefined&&e(n===undefined||n)}catch(i){t(i)}})},n(e,t)},oaQueueProvider=window.oa.tagging.createQueueProvider(window.oa.tagging,window.oa.tagging.data.store),window.oa.tagging.queueProvider=oaQueueProvider,oaSetupProvider.addSetupFunc(\"prepare_conversionListenerUtils\",function(e,u){u.set(\"isIxpFormFound\",function(){return\"undefined\"!=typeof window.ixp&&\"undefined\"!=typeof window.ixp.runtime&&\"undefined\"!=typeof window.ixp.runtime.components&&-1!==Object.keys(window.ixp.runtime.components.instancesByType).indexOf(\"ixp-form\")},{defaultValue:!1,autoPopSetting:\"always\"}),u.set(\"isConfirmationPage\",function(e){var t=e!==undefined?e:u.get(\"location\"),n=t.pathname,i=t.href,r=t.hostname,o=u.get(\"jquery\"),a=-1!==document.cookie.indexOf(\"oa_session\"),s=!1;return\"info.microsoft.com\"===r?(n.match(/thank/i)&&a||n.match(/confirm/i)&&a||!o(\"#formArea\").length&&!o(\"#formWrapper\").length&&!o(\".event-listings\").length&&a||-1!==i.indexOf(\"info.microsoft.com/CO-SQL-Trial-FY17-10Oct-Microsite-Trial-Download_Download-en-au\"))&&(s=!0):\"products.office.com\"===r&&-1!==n.indexOf(\"en/tracking\")?s=!0:\"resources.office.com\"!==r&&\"discover.microsoft.com\"!==r&&\"discover.office.com\"!==r||(n.match(/thank/i)&&a||n.match(/confirm/i)&&a)&&(s=!0),s},{defaultValue:null,autoPopSetting:\"always\"}),u.set(\"_arrayContainsValueFromOtherArray\",function(e,t){if(e&&e.constructor===Object){var n=[];for(var i in e)n.push(i);e=n}if(t&&t.constructor===Object){n=[];for(var i in t)n.push(i);t=n}for(var r=[],o={},a=0;a<e.length;a++){var s=e[a];if(!o[s])for(var u=0;u<t.length;u++)t[u]===s&&(r.push(s),o[s]=!0)}return r},{defaultValue:null,autoPopSetting:\"once\"})}),oaSetupProvider.addSetupFunc(\"prepare_detectConversion\",function(h,m){m.set(\"detectConversionLogic\",function(e){var t=e.credited,n=e.knownLocation?e.knownLocation.toLowerCase():\"\",i=e.order_type?e.order_type.toLowerCase():\"\",r=e.skus,o=e.knownPageType?e.knownPageType.toLowerCase():\"\",a=m.get(\"isOfficePurchase\"),s=m.get(\"isOfficeTrial\"),u=m.get(\"isDynamicsPurchase\"),l=m.get(\"isDynamicsTrial\"),c=m.get(\"isStudentOrTeacher\"),g=m.get(\"isPowerBiTrial\"),d=m.get(\"isAzureTrial\"),f=null;try{\"roc\"===n&&\"thankyou\"===o&&(f=\"office lead\"),\"imc\"===n&&\"thankyou\"===o&&(f=\"ce lead\"),\"techsummit\"===n&&(f=\"ce lead\"),\"ms events\"===n&&(f=\"ce lead\"),\"ms events::build\"===n&&(f=\"ce lead\"),\"ms events::ignite\"===n&&(f=\"ce lead\"),\"ms events::envision\"===n&&(f=\"ce lead\"),\"ms events::businessappssummit\"===n&&(f=\"ce lead\"),\"ms events::ignitetour\"===n&&(f=\"ce lead\"),\"content\"===n&&(f=\"ce lead\"),\"indigo\"===n&&(f=\"ce lead\"),t&&\"poc iframe\"===n&&\"commercial purchase complete\"===i&&a(r)&&(f=\"office commercial smb purchase\"),\"poc iframe\"===n&&\"commercial trial complete\"===i&&s(r)&&(f=\"office commercial trial\"),\"poc iframe\"===n&&\"signup complete\"===i&&c(r)&&(f=\"office student/teacher signup\"),\"poc iframe\"===n&&\"commercial purchase complete\"===i&&u(r)&&(f=\"dynamics 365 purchase\"),\"poc iframe\"!==n||\"commercial trial complete\"!==i&&\"signup complete\"!==i||!l(r)||(f=\"dynamics 365 trial\"),\"poc iframe\"===n&&\"signup complete\"===i&&g(r)&&(f=\"powerbi trial\"),\"azure\"!==n||d(r)||(f=\"azure purchase\"),\"azure\"===n&&d(r)&&(f=\"azure trial\"),\"defender atp\"===n&&(f=\"windows trial\"),\"ailab\"===n&&(f=\"ai lab upload\"),\"discover_microsoft\"===n&&(f=\"ce lead\"),\"discover_office\"===n&&(f=\"ce lead\")}catch(\np){h.logger.error(\"setup_conversionLogic\",\"exception \"+p),f=\"\"}return f},{defaultValue:null,autoPopSetting:\"once\"})}),oaSetupProvider.addSetupFunc(\"prepare_ctagData\",function(e,h){h.set(\"cTagParam_default\",{dl_sku:\"[OFFER ID]\",dl_seats:\"[SEATS]\",dl_order_id:\"[ORDER ID]\",c_size:\"[EMPLOYEE SIZE]\"},{defaultValue:{},autoPopSetting:\"once\"}),h.set(\"cTag_data\",function m(e){\"use strict\";var t=h.get(\"tealiumDL\"),n=h.get(\"location\"),i=h.get(\"jquery\"),r={llcc:\"[LANGLOC]\",dl_country:\"[COUNTRY]\",dl_assettype:\"[ASSET TYPE]\",dl_pageid:\"[ASSET TYPE]\",dl_sku:\"[OFFER ID]\",dl_seats:\"[SEATS]\",dl_order_id:\"[ORDER ID]\",c_size:\"[EMPLOYEE SIZE]\",guid:\"[ORDER ID]\",pageUrl:n.href};switch(e.toLowerCase()){case\"imc\":case\"discover_microsoft\":case\"discover_office\":(f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0]:\"[ASSET TYPE]\")&&\"object\"==typeof f&&(f=f.content);var o=h.get(\"llcc\")&&null!==h.get(\"llcc\")?h.get(\"llcc\"):\"[LANGLOC]\";r.llcc=o,r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.dl_assettype=t.asset_type?t.asset_type:\"[ASSET TYPE]\",r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\",r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.order_id=r.guid,r.dl_pageid=f,r.pageUrl=n.href;break;case\"roc\":(f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0].content:\"[ASSET TYPE]\")&&\"object\"==typeof f&&(f=f.content);o=h.get(\"llcc\")&&null!==h.get(\"llcc\")?h.get(\"llcc\"):\"[LANGLOC]\";r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.dl_assettype=t.asset_type?t.asset_type:\"[ASSET TYPE]\",r.dl_pageid=f,r.dl_audience=t.page_audience?t.page_audience:\"\",r.dl_product=h.get(\"product_string\"),r.dl_pagetype=t.page_type?t.page_type:\"\",r.dl_pageintent=t.page_intent?t.page_intent:\"\",r.dl_sitesection=t.site_section?t.site_section:\"\",r.dl_pgterm=0<i(\"meta[name='MS.pgterm']\").length?i(\"meta[name='MS.pgterm']\").attr(\"content\"):\"\",r.pageUrl=n.href,r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\",r.llcc=o,r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.order_id=r.guid;break;case\"poc iframe\":var a=h.get(\"dl_iframe_vals\"),s=h.get(\"dl_matched\"),u=s.matchedOffers||{},l=s.credited||undefined,c=a.dl_type,g=a.dl_sku?a.dl_sku:\"[OFFER ID]\",d=\"[PRODUCT NAME]\";0<g.length&&0<Object.keys(u).length&&(d=typeof l!==undefined?u[g[0]].offer_prod_full_name:d);var f=t.universal_page_id?t.universal_page_id:\"[ASSET TYPE]\";o=h.get(\"llcc\")&&null!==h.get(\"llcc\")?h.get(\"llcc\"):\"[LANGLOC]\";r.llcc=o,r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.dl_assettype=t.asset_type?t.asset_type:\"[ASSET TYPE]\",r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\",r.dl_seats=a.dl_seats?a.dl_seats:\"[SEATS]\",r.dl_type=c,r.dl_matched=s,r.credited=l,r.dl_sku=g,r.dl_order_id=a.dl_order_id?a.dl_order_id:\"[ORDER ID]\",r.dl_locale=a.dl_locale?a.dl_locale:\"[COUNTRY]\",r.product_name=d,r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.dl_pageid=f,r.pageUrl=n.href;break;case\"azure\":r.offerID=h.get(\"location\").search.match(/[?&]offer(Id)?=/gi)?h.get(\"location\").search.match(/offer(Id)?=.[^&]+&?/gi)[0].split(\"=\")[1].replace(\"&\",\"\"):\"\",r.order_id=\"[ORDER ID]\",r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\";break;case\"content\":f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0]:\"[ASSET TYPE]\";r.dl_pageid=f&&\"object\"==typeof f?f.content:f;o=h.get(\"llcc\")&&null!==h.get(\"llcc\")?h.get(\"llcc\"):\"[LANGLOC]\";r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.c_size=null!==document.querySelector(\"[data-ixp-input-data-field='companySize']\")&&JSON.parse(document.querySelector(\"[data-ixp-input-data-field='companySize']\").getAttribute(\"data-ixp-input-state\"))?JSON.parse(document.querySelector(\"[data-ixp-input-data-field='companySize']\").getAttribute(\"data-ixp-input-state\")).value:\"[EMPLOYEE SIZE]\";break;case\"defender atp\":f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0]:\"[ASSET TYPE]\";r.dl_pageid=f&&\"object\"==typeof f?f.content:f;o=h.get(\"llcc\")&&null!==h.get(\"llcc\")?h.get(\"llcc\"):\"[LANGLOC]\";r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\";break;case\"indigo\":f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0]:\"[ASSET TYPE]\";r.dl_pageid=f&&\"object\"==typeof f?f.content:f;o=h.get(\"llcc\")&&null!==h.get(\"llcc\")?h.get(\"llcc\"):\"[LANGLOC]\";r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.c_size=document.getElementById(\"companysize\").options[document.getElementById(\"companysize\").selectedIndex].text?document.getElementById(\"companysize\").options[document.getElementById(\"companysize\").selectedIndex].text:\"[Company Size]\";break;case\"techsummit\":f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0]:\"[ASSET TYPE]\";r.dl_pageid=f&&\"object\"==typeof f?f.content:f;o=h.get(\"llcc\");var p=h.get(\"llcc_MeControl\");o&&null!==o?r.llcc=o:p&&null!==p&&(r.llcc=p),r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\";break;case\"ms events\":case\"ms events::ignite\":case\"ms events::envision\":case\"ms events::build\":f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0]:\"[ASSET TYPE]\";r.dl_pageid=f&&\"object\"==typeof f?f.content:f;o=h.get(\"llcc\"),p=h.get(\"llcc_MeControl\");o&&null!==o?r.llcc=o:p&&null!==p&&(r.llcc=p),r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\";break;case\"ailab\":f=i(\"meta[name='ms.ea_targetcampaign']\")[0]?i(\"meta[name='ms.ea_targetcampaign']\")[0]:\"[ASSET TYPE]\";r.dl_pageid=f&&\"object\"==typeof f?f.content:f,(o=h.get(\"llcc\"))&&null!==o&&(r.llcc=o),r.dl_country=o&&\"[LANGLOC]\"!==o&&-1!==o.indexOf(\"-\")?o.split(\"-\")[1]:\"[COUNTRY]\",r.guid=h.get(\"guid\")?h.get(\"guid\"):\"[ORDER ID]\",r.c_size=h.get(\"company_size\")?h.get(\"company_size\"):\"[EMPLOYEE SIZE]\"}return r},{defaultValue:{},autoPopSetting:\"once\"})}),oaSetupProvider.addSetupFunc(\"prepare_setConversionListeners\",function(m,v){v.set(\"addConversionListener\",function(e,t){var n=!1;switch(e){case\"roc\":case\"imc\":v.get(\"isConfirmationPage\")()||(n=\"setMarketoConversionListener\");break;case\"signup azure\":n=\"setSignupAzureConversionListener\";break;case\"content\":n=\"setContentMicrosoftConversionListener\";break;case\"ms events\":n=\"setMSEventsConversionListener\";break;case\"defender atp\":n=\"windowsTrialConversionListener\";break;case\"techsummit\":case\"ms events::build\":n=\"setEventcoreConversionListener\";break;case\"ms events::ignite\":case\"ms events::envision\":case\"ms events::businessappssummit\":n=\"setEventcoreConfirmRegConversionListener\";break;case\"indigo\":n=\"setIndigoConversionListener\";break;default:return null}return n?v.get(n)(e,t):null},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"setMarketoConversionListener\",function(e,t){var s=v.get(\"jquery\"),u=v.get(\"isDebug\"),n=function(r,o,a){for(var e=r.allForms().constructor===Array?r.allForms():[],t=0;t<e.length;t++){var n=e[t].getFormElem().selector,i=u?\"contextmenu\":\"submit\";s(n).on(i,function(e){var t=v.get(\"cTag_data\")(o);t.conversionType=v.get(\"detectConversionLogic\")({knownLocation:o?o.toLowerCase():\"\",knownPageType:\"thankyou\"});var n=e.currentTarget,i=!1;\"FORM\"===n.tagName&&n.id&&null!==n.id.match(\"mktoForm_\")&&(i=n.id.split(\"mktoForm_\")[1]),i&&r.getForm(i).validate()&&(t.eventData=e,v.set(\"cData\",t),a(t))})}},i=window.MktoForms2;return i?(\"function\"==typeof i.allForms&&i.allForms().constructor===Array&&0!==i.allForms().length?n(i,e,t):i.whenReady(function(){n(i,e,t)}),!0):null},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"setSignupAzureConversionListener\",function(e,o){var t=v.get(\"location\"),n=t.hostname,i=t.href,r=\"account.azure.com\",a=r+\"/signuplanding/index\",s=n===\"signup.azure.com\",u=n===r&&i.toLowerCase().match(a);try{var l=v.get(\"cTag_data\")(e);if(l.conversionType=v.get(\"detectConversionLogic\")({knownLocation:e?e.toLowerCase():\"\",skus:[l.offerID.toLowerCase()]}),s)document.addEventListener(\"kpiEvent\",function(e){var t=e.detail,n=t&&\"string\"==typeof t.message?t.message:null;if(null!==n&&\"PurchaseComplete\"===n)try{var i=t.additionalInfo&&null!==t.additionalInfo?JSON.parse(t.additionalInfo):{};l.commerceSubscriptionId=i.commerceSubscriptionId?i.commerceSubscriptionId:\"[Commerce Subscription ID]\",l.azureSubscriptionId=i.azureSubscriptionId?i.azureSubscriptionId:\"[Azure Subscription ID]\",l.eventData=t,v.set(\"cData\",l),o(l)}catch(r){m.logger.error(\"setSignupAzureConversionListener\",\"Failed to handle signup.azure.com conversion flow\"),m.logger.error(\"setSignupAzureConversionListener\",r)}});else{if(!u)return null;try{var c=null;\"undefined\"!=typeof window.Signup&&\"undefined\"!=typeof window.Signup.Landing&&(c=window.Signup.Landing.resources.SubscriptionId?window.Signup.Landing.resources.SubscriptionId:null),l.commerceSubscriptionId=null!==c?c:\"[Commerce Subscription ID]\",l.azureSubscriptionId=null!==c?c:\"[Azure Subscription ID]\",window.oa.tagging.eventDriver.oaPromise(function(){v.set(\"cData\",l),o(l)})}catch(g){return m.logger.error(\"setSignupAzureConversionListener\",\"Failed to handle account.azure.com conversion flow\"),m.logger.error(\"setSignupAzureConversionListener\",g),null}}return!0}catch(g){return m.logger.error(\"setSignupAzureConversionListener\",g),null}},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"setContentMicrosoftConversionListener\",function(l,e){try{var c=v.get(\"jquery\"),g=v.get(\"isDebug\");v.get(\"ixpListenerReady\")===undefined&&v.set(\"ixpListenerReady\",!1);var d=function(e){return e&&0<Object.keys(e).length&&\"undefined\"!=typeof e.runtime&&\"undefined\"!=typeof e.runtime.components&&\"undefined\"!=typeof e.runtime.components.instances&&\"undefined\"!=typeof e.runtime.components.instancesByType},t=function(e,t,n){if(!d(e))return window.oa.tagging.logger.error(\"setContentMicrosoftConversionListener\",\"Form information unavailable\"),null;var i=e.runtime.components;if(!i.instancesByType[\"ixp-form\"])return window.oa.tagging.logger.error(\"setContentMicrosoftConversionListener\",\"Failed to find form on page at page load\"),null;var r=\"undefined\"!=typeof i.instancesByType[\"ixp-form\"]&&i.instancesByType[\"ixp-form\"].constructor===Object?Object.keys(i.instancesByType[\"ixp-form\"]):[];if(!(\"undefined\"!=typeof i.instancesByType[\"ixp-textbox\"]&&i.instancesByType[\"ixp-textbox\"].constructor===Object&&1<Object.keys(i.instancesByType[\"ixp-textbox\"]).length))return window.oa.tagging.logger.error(\"setContentMicrosoftConversionListener\",\"Form does not appear to be a valid registration form\"),null;for(var o=0;o<r.length;o++){var a=r[o],s=\"undefined\"!==i.instances[a]&&i.instances[a].instance&&i.instances[a].instance.$el?i.instances[a].instance.$el.selector:\"\",u=g?\"contextmenu\":\"submit\";c(s).on(u,function(e){var t=v.get(\"cTag_data\")(l);t.conversionType=v.get(\"detectConversionLogic\")({knownLocation:l?l.toLowerCase():\"\"}),window.oa.tagging.logger.info(\"setContentMicrosoftConversionListener\",\"Firing...\"),t.eventData=e,v.set(\"cData\",t),n(t)})}return window.oa.tagging.logger.info(\"setContentMicrosoftConversionListener\",\"IXP ready state triggered; listener now fully set up\"),v.set(\"ixpListenerReady\",!0),!0};return window.ixp?(ixp.runtime.ready(function(){t(window.ixp,l,e)}),!0):null}catch(n){return window.oa.tagging.logger.error(\"setContentMicrosoftConversionListener\",n),null}},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"setEventcoreConversionListener\",function(e,t){try{var n=v.get(\"cTag_data\")(e);n.conversionType=v.get(\"detectConversionLogic\")({knownLocation:e?e.toLowerCase():\"\"});var i=v.get(\"location\");return i.hostname.match(/(register\\.[a-zA-Z]+\\.microsoft\\.com|\\.eventcore\\.com)/i)&&!(!i.pathname.match(/\\/edit\\/?$/i)||null===document.querySelector(\"script[src*='/edit/confirmcomplete']\"))?(window.oa.tagging.eventDriver.oaPromise(function(){v.set(\"cData\",n),t(n)}),!0):null}catch(r){return window.oa.tagging.logger.error(\"setEventcoreConversionListener\",r),null}},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"setEventcoreConfirmRegConversionListener\",function(e,t){try{var n=v.get(\"cTag_data\")(e);if(n.conversionType=v.get(\"detectConversionLogic\")({knownLocation:e?e.toLowerCase():\"\"}),v.get(\"location\").hostname.match(/(register\\.[a-zA-Z]+\\.microsoft\\.com)|(eventcore\\.com)/i)){var i,r=document.querySelector(\"script[src*='/edit/confirmregistration'][src*='userCount='][src*='registrantID=']\");return null!==r?(i=!0,n.numRegistrations=r.src.split(\"userCount=\")[1].split(\"&\")[0],n.registrantId=r.src.split(\"registrantID=\")[1].split(\"&\")[0]):i=!1,i?(window.oa.tagging.eventDriver.oaPromise(function(){v.set(\"cData\",n),t(n)}),!0):null}return null}catch(o){return window.oa.tagging.logger.error(\"setEventcoreConfirmRegConversionListener\",o),null}},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"setIndigoConversionListener\",function(n,i){var e=v.get(\"jquery\"),t=v.get(\"isDebug\");try{v.get(\"cTag_data\")(n).conversionType=v.get(\"detectConversionLogic\")({knownLocation:n?n.toLowerCase():\"\"});var r=\"marketo-continue-button\",o=v.get(\"location\");if(o.hostname.match(/datamodernizationplanner.azurewebsites.net/i)&&\"/\"==o.pathname){var a=t?\"contextmenu\":\"click\";return e(document).on(a,function(){if(0<this.path.length)for(var e=0;e<this.path.length;e++){if(this.path[e].id==r)(t=v.get(\"cTag_data\")(n)).conversionType=v.get(\"detectConversionLogic\")({knownLocation:n?n.toLowerCase():\"\",knownPageType:\"thankyou\"}),v.set(\"cData\",t),i(t)}var t;this.target.id===r&&((t=v.get(\"cTag_data\")(n)).conversionType=v.get(\"detectConversionLogic\")({knownLocation:n?n.toLowerCase():\"\",knownPageType:\"thankyou\"}),v.set(\"cData\",t),i(t))}),!0}return null}catch(s){return window.oa.tagging.logger.error(\"setIndigoConversionListener\",s),null}},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"msEventsRegistrationComplete\",!1),v.set(\"setMSEventsConversionListener\",function(t,n){try{var e=v.get(\"location\").hostname.match(/microsoftevents\\.com/i),i=v.get(\"isDebug\"),r=v.get(\"jquery\"),o=m.util.getCookie,a=m.util.deleteCookie,s=m.util.createCookie,u=\"#errorStack\",l=\"oa_MSEventsRegSubmitted\",c=o(l),g=function(){c&&a(l),window.oa.tagging.eventDriver.oaPromise(function(){var e=v.get(\"cTag_data\")(t);e.conversionType=v.get(\"detectConversionLogic\")({knownLocation:t?t.toLowerCase():\"\"}),v.set(\"cData\",e),n(e)})};if(e){if(c&&\"true\"===c&&0===r(u).length&&v.set(\"msEventsRegistrationComplete\",!0),v.get(\"msEventsRegistrationComplete\"))return g(),!0;var d=i?\"#submitForm\":\"form\";if(0<r(d).length){var f=i?\"contextmenu\":\"submit\";return r(d).on(f,function(){i?(v.set(\"msEventsRegistrationComplete\",!0),g()):c||s(l,\"true\")}),!0}return null}return null}catch(p){return window.oa.tagging.logger.error(\"setMSEventsConversionListener\",p),null}},{defaultValue:null,autoPopSetting:\"always\"}),v.set(\"windowsTrialSignupComplete\",!1),v.set(\"windowsTrialConversionListener\",function(t,n){try{var e=v.get(\"location\").pathname.match(/(ContactInformation|Finish)$/i),i=v.get(\"isDebug\"),r=v.get(\"jquery\"),o=m.util.getCookie,a=m.util.deleteCookie,s=m.util.createCookie,u=\".field-validation-error\",l=\".registration-content-justified\",c=\"oa_winTrialRegSubmitted\",g=o(c),d=function(){g&&a(c),window.oa.tagging.eventDriver.oaPromise(function(){var e=v.get(\"cTag_data\")(t);e.conversionType=v.get(\"detectConversionLogic\")({knownLocation:t?t.toLowerCase():\"\"}),v.set(\"cData\",e),n(e)})};if(e){if(g&&\"true\"===g&&0===r(u).length&&0<r(l).length&&v.set(\"windowsTrialSignupComplete\",!0),v.get(\"windowsTrialSignupComplete\"))return d(),!0;var f=i?\"#contactInformationSubmit\":\"form\";if(0<r(f).length){var p=i?\"contextmenu\":\"submit\";return r(f).on(p,function(){i?(v.set(\"windowsTrialSignupComplete\",!0),d()):g||s(c,\"true\")}),!0}return null}return null}catch(h){return window.oa.tagging.logger.error(\"windowsTrialConversionListener\",h),null}},{defaultValue:null,autoPopSetting:\"always\"})}),oaSetupProvider.addSetupFunc(\"prepare_conversionlogic\",function(e,n){n.set(\"studentOrTeacher\",[\"78e66a63-337a-4a9a-8959-41c6654dfb56\",\"e82ae690-a2d5-4d76-8d30-7c6e01e6022e\",\"314c4481-f395-4525-be8b-2ec4bb1e9d91\",\"94763226-9b3c-4e75-a931-5c89701abe66\"],{defaultValue:{},autoPopSetting:\"once\"}),n.set(\"dynamics_purchase\",[\"95142fe2-f5e1-4585-88c0-f2d0f0f84f35\",\"7d99fd82-7195-410d-a9d0-2d3a144d8606\",\"4fe1cd4d-88c3-4a81-8235-0ba2b49bba9f\",\"39ce6204-6bb5-4ff1-a2a7-3b03c53731c1\"],{defaultValue:{},autoPopSetting:\"once\"}),n.set(\"dynamics_trial\",[\"6a4a1628-9b9a-424d-bed5-4118f0ede3fd\",\"fcecd1f9-a91e-488d-a918-a96cdb6ce2b0\",\"338148b6-1b11-4102-afb9-f92b6cdc0f8d\",\"bd569279-37f5-4f5c-99d0-425873bb9a4b\",\"dcb1a3ae-b33f-4487-846a-a640262fadf4\"],{defaultValue:{},autoPopSetting:\"once\"}),n.set(\"powerBi_trial\",[\"a403ebcc-fae0-4ca2-8c8c-7a907fd6c235\"],{defaultValue:{},autoPopSetting:\"once\"}),n.set(\"azure_offerId\",[\"ms-azr-0044p\"],{defaultValue:{},autoPopSetting:\"once\"}),n.set(\"isOfficePurchase\",function(e){return!n.get(\"isDynamicsPurchase\")(e)},{defaultValue:null,autoPopSetting:\"once\"}),n.set(\"isOfficeTrial\",function(e){return!n.get(\"isDynamicsTrial\")(e)},{defaultValue:null,autoPopSetting:\"once\"}),n.set(\"isDynamicsPurchase\",function(e){var t=n.get(\"dynamics_purchase\");return 0<n.get(\"_arrayContainsValueFromOtherArray\")(e,t).length},{defaultValue:null,autoPopSetting:\"once\"}),n.set(\"isDynamicsTrial\",function(e){var t=n.get(\"dynamics_trial\");return 0<n.get(\"_arrayContainsValueFromOtherArray\")(e,t).length},{defaultValue:null,autoPopSetting:\"once\"}),n.set(\"isStudentOrTeacher\",function(e){var t=n.get(\"studentOrTeacher\");return 0<n.get(\"_arrayContainsValueFromOtherArray\")(e,t).length},{defaultValue:null,autoPopSetting:\"once\"}),n.set(\"isPowerBiTrial\",function(e){var t=n.get(\"powerBi_trial\");return 0<n.get(\"_arrayContainsValueFromOtherArray\")(e,t).length},{defaultValue:null,autoPopSetting:\"once\"}),n.set(\"isAzureTrial\",function(e){var t=n.get(\"azure_offerId\");return 0<n.get(\"_arrayContainsValueFromOtherArray\")(e,t).length},{defaultValue:null,autoPopSetting:\"once\"})}),oaSetupProvider=window.oa.tagging.setupProvider,oaDataStore=window.oa.tagging.data.store,oaQueueProvider=window.oa.tagging.queueProvider,oaDataStore.register(\"location\",{defaultValue:\"\",autoPopSetting:\"once\"},function(){return document.location}),oaDataStore.register(\"isDebug\",{defaultValue:!1,autoPopSetting:\"once\"},function(){return-1!==oaDataStore.get(\"location\").search.indexOf(\"blueprint=1\")||\"true\"===window.oa.tagging.util.getCookie(\"cfDebug\")}),oaDataStore.register(\"enrichments\",{defaultValue:undefined,autoPopSetting:\"once\"},function(){try{return window.utag&&window.utag.globals&&window.utag.globals.dle?window.utag.globals.dle.enrichments:window.oa.enrichments?window.oa.enrichments:(window.oa.tagging.logger.warn(\"enrichments\",\"Unable to locate enrichments on the page\"),null)}catch(e){return window.oa.tagging.logger.error(\"setup\",\"Enrichments error\"),window.oa.tagging.logger.error(\"setup\",e),null}}),oaDataStore.register(\"enrichments_obj\",{defaultValue:null,autoPopSetting:\"once\"},function(){try{var e=oaDataStore.get(\"enrichments\"),t=oaDataStore.get(\"location\");for(var n in e)if(-1!==n.indexOf(t.hostname.replace(/\\./g,\"-\")))return e[n];return null}catch(i){return window.oa.tagging.logger.error(\"setup\",\"Enrichments error\"),window.oa.tagging.logger.error(\"setup\",i),null}}),oaDataStore.register(\"query_string\",{defaultValue:\"\",autoPopSetting:\"once\"},function(){var r={};return location.search&&location.search.substr(1).split(\"&\").forEach(function(e){var t=e.split(\"=\"),n=t[0],i=t[1]&&decodeURIComponent(t[1]);(r[n]=r[n]||[]).push(i)}),r}),oaDataStore.register(\"jquery\",{defaultValue:{},autoPopSetting:\"once\"},function(){return window.jQuery?window.jQuery:window.oa.tagging.util.jQuery}),oaSetupProvider.addSetupFunc(\"getMC1\",function(i,e){e.register(\"mc1\",{defaultValue:null,autoPopSetting:\"always\"},function(){var e=i.util.getCookie(\"MC1\"),t=\"\";if(e)try{t=e.split(\"=\")[1].split(\"&\")[0]}catch(n){t=\"\"}return t})}),oaSetupProvider.addSetupFunc(\"getMSFPC\",function(n,e){e.register(\"msfpc\",{defaultValue:null,autoPopSetting:\"always\"},function(e){var t=n.util.getCookie(\"MSFPC\");return t=null!==t&&t.match(/((?:id=)|(?:guid=))(([a-z]|[0-9])*)/i)[2],n.setup.complete.getMSFPC=!0===e.values,t}),e.get(\"msfpc\",!0)}),oaSetupProvider.addSetupFunc(\"getANID\",function(e,t){t.register(\"anid\",{defaultValue:\"\",autoPopSetting:\"always\"},function(){return null!==document.cookie.match(/anon=a=(.*)&/i)?document.cookie.match(/anon=a=(.*)&/i)[1]:0})}),oaSetupProvider.addSetupFunc(\"setguid\",function(i,t){t.register(\"guid\",{defaultValue:null,autoPopSetting:\"once\"},function(){function e(){function e(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})}function t(){function e(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return r[255&e]+r[e>>8&255]+r[e>>16&255]+r[e>>24&255]+\"-\"+r[255&t]+r[t>>8&255]+\"-\"+r[t>>16&15|64]+r[t>>24&255]+\"-\"+r[63&n|128]+r[n>>8&255]+\"-\"+r[n>>16&255]+r[n>>24&255]+r[255&i]+r[i>>8&255]+r[i>>16&255]+r[i>>24&255]}for(var r=[],t=0;t<256;t++)r[t]=(t<16?\"0\":\"\")+t.toString(16);return e()}try{return e()}catch(n){return t()}}return e()}),t.register(\"shortguid\",{defaultValue:null,autoPopSetting:\"once\"},function(){var e=t.get(\"guid\");return i.util.encodeASCII85(i.util.guidToBytes(e))}),t.register(\"shortguid_func\",{defaultValue:null,autoPopSetting:\"once\"},function(){return function(e){var t=e;try{return i.util.encodeASCII85(i.util.guidToBytes(t))}catch(n){return window.oa.tagging.logger.error(\"shortguid_func\",\"unable to convert guid\"),null}}}),t.register(\"noncryptoshortid\",{defaultValue:null,autoPopSetting:\"once\"},function(){function e(e,t){t=t||\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";for(var n=\"\",i=0;i<e;i++){var r=Math.floor(Math.random()*t.length);n+=t.substring(r,r+1)}return n}return t.get(\"isDebug\")?t.get(\"shortguid_func\")?t.get(\"shortguid_func\")(window.orderId):\"testordershortid\":e(20)})}),oaSetupProvider.addSetupFunc(\"getLLCC\",function(i,n){n.register(\"llcc_full\",{defaultValue:null,autoPopSetting:\"always\"},function(){var e=n.get(\"location\").href,t=new RegExp(/((?:\\W|_)([a-zA-Z]{2}-[a-zA-Z]{2})(?:\\W|_|$))|((?:\\W|_)[a-z]{2}-[a-z]{4}-[a-z]{2}(?:\\W|_))|(\\/[a-zA-Z]{2}\\/)/i);return e.match(t)}),n.register(\"llcc\",{defaultValue:\"\",autoPopSetting:\"once\"},function(){var e=null!==n.get(\"llcc_full\")?n.get(\"llcc_full\")[2].toLowerCase():null;return i.setup.complete.getLLCC=!0,e}),n.register(\"loc\",{defaultValue:\"\",autoPopSetting:\"once\"},function(){var e=null!==n.get(\"llcc\")?n.get(\"llcc\"):null;return e&&-1!==e.indexOf(\"-\")?e.split(\"-\")[1]:null}),n.register(\"llcc_body\",{defaultValue:null,autoPopSetting:\"always\"},function(){try{return document.getElementsByTagName(\"body\")[0].getAttribute(\"lang\").toLowerCase()}catch(e){return i.logger.warn(\"llcc_body\",\"Unable to retrieve llcc_body.\"),i.logger.warn(\"llcc_body\",e),null}}),n.register(\"llcc_html\",{defaultValue:null,autoPopSetting:\"always\"},function(){try{return document.getElementsByTagName(\"html\")[0].getAttribute(\"lang\").toLowerCase()}catch(e){return i.logger.error(\"llcc_html\",\"Error when retrieving llcc_html.\"),i.logger.error(\"llcc_html\",e),null}}),n.register(\"llcc_MeControl\",{defaultValue:null,autoPopSetting:\"always\"},function(){try{var e=window.MSA;if(e&&e.MeControl&&e.MeControl.Config){var t=e.MeControl.Config.mkt;return t&&\"string\"==typeof t&&0<t.length?t.toLowerCase():null}return null}catch(n){return i.logger.error(\"llcc_MeControl\",\"Error when retrieving llcc_MeControl.\"),i.logger.error(\"llcc_MeControl\",n),null}}),n.get(\"llcc\",!0)}),oaSetupProvider.addSetupFunc(\"Setup oa_session\",function(n,i){i.register(\"oa_session\",{defaultValue:null,autoPopSetting:\"once\"},function(){var e=n.util.getCookie(\"oa_session\"),t=i.get(\"isConfirmationPage\")();return null===e&&!1===t&&(e=i.get(\"guid\"),document.cookie=\"oa_session=\"+e),e})}),oaSetupProvider.addSetupFunc(\"getTealiumDL\",function(o,a){a.register(\"tealiumDL\",{defaultValue:[],autoPopSetting:\"once\"},function(){try{var e=a.get(\"enrichments\");if(null===e||e===undefined)return[];var t={};for(var n in e)if(\"object\"==typeof e[n])for(var i in e[n])t[i]=e[n][i];return o.setup.complete.getTealiumDL=!0,t}catch(r){return window.oa.tagging.logger.error(\"setup\",\"Error in get tealiumDL\"),window.oa.tagging.logger.error(\"setup\",r),[]}}),a.get(\"tealiumDL\",!0)}),oaSetupProvider.addSetupFunc(\"matchFwLinks\",function(e,d){return d.register(\"anchorTags\",undefined,function(){return document.getElementsByTagName(\"a\")}),d.register(\"fwlinks\",{defaultValue:!1,autoPopSetting:\"once\"},function(){for(var e=d.get(\"anchorTags\",!0),t=[],n=0;n<e.length;n++){var i,r=e[n];r.href&&-1!==r.href.indexOf(\"go.microsoft.com\")&&r.href.match(/linkid/i)&&null!==(i=r.href.match(/linkid=(.*)&?/i))&&i!==undefined&&t.push(i[1].split(\"&\")[0])}return 0!==t.length&&t}),d.register(\"matchedfwlinks\",undefined,function(){var e=d.get(\"fwlinks\"),t=d.get(\"tealiumDL\"),n=Object.keys(t),i={},r=[],o=!1;if(!1!==e){for(var a=0;a<n.length;a++){var s=t[n[a]].fwlink_id;if(s&&s.constructor===Array)for(var u=0;u<s.length;u++){var l=s[u];-1!==e.indexOf(l)?i[n[a]]=t[n[a]]:r.push(t[n[a]])}}if(i!==undefined&&0<Object.keys(i).length)for(var c in i)if(\"subscription\"===i[c].offer_license_type){o=!0;break}}var g={};return g.matchedFwLinks=i,g.notMatchedFwlinks=r,g.credited=o,g}),!0}),oaSetupProvider.addSetupFunc(\"product_setup\",function(e,t){return t.register(\"product\",{defaultValue:[],autoPopSetting:\"once\"},function(){var e=t.get(\"matchedfwlinks\").matchedFwLinks;return Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),Object.keys(e)}),t.register(\"product_string\",{defaultValue:[],autoPopSetting:\"once\"},function(){return t.get(\"product\").toString()}),!0}),oaSetupProvider.addSetupFunc(\"company_size\",function(t,e){e.register(\"company_size\",{defaultValue:null,autoPopSetting:\"always\"},function(){var e=document.getElementById(\"employeeRange\");return e&&e.value&&\"\"!=e.value?e.value:null!==t.util.getCookie(\"quantC_size\")?t.util.getCookie(\"quantC_size\"):null})}),oaSetupProvider.addSetupFunc(\"add_raw_iframe_values\",function(o,e){e.register(\"iframe_values\",{defaultValue:{},autoPopSetting:\"once\"},function(){if(-1===document.location.href.indexOf(\"products.office.com/en/tracking\"))return{};for(var e={},t=[\"ms.office_part_number\",\"ms.ocpub.assetid\",\"ms.trans_market\",\"ms.office_order_id\",\"ms.ms_sales_part_quantity\",\"ms.office_tid\"],n=0;n<t.length;n++){var i=o.util.getQueryParam(t[n]).toLowerCase();if(\"\"!==i){var r=t[n];\"ms.office_part_number\"===r&&1<i.split(\",\").length?e[r]=i.split(\",\"):e[r]=[i]}}return e})}),oaSetupProvider.addSetupFunc(\"add_iframe_values_to_dl\",function(e,u){u.register(\"dl_iframe_vals\",{defaultValue:{},autoPopSetting:\"once\"},function(){if(-1===document.location.href.indexOf(\"products.office.com/en/tracking\"))return{};var e={},t=u.get(\"iframe_values\"),n=t[\"ms.office_part_number\"],i=t[\"ms.ocpub.assetid\"],r=t[\"ms.trans_market\"],o=t[\"ms.ms_sales_part_quantity\"],a=t[\"ms.office_order_id\"],s=t[\"ms.office_tid\"];return e.dl_sku=n&&n.constructor===Array?n:[],e.dl_type=i&&i.constructor===Array?i.join(\",\"):\"\",e.dl_locale=r&&r.constructor===Array?r.join(\",\"):\"\",e.dl_seats=o&&o.constructor===Array?o.join(\",\"):\"0\",e.dl_order_id=a&&a.constructor===Array?a.join(\",\"):\"\",e.dl_tenant_id=s&&s.constructor===Array?s.join(\",\"):\"\",e})}),oaSetupProvider.addSetupFunc(\"prepare_iframeMatches\",function(e,i){i.set(\"buildMatchedState\",function l(e,t,n){for(var i=\"object\"==typeof n?Object.keys(n):[],r=0;r<t.length;r++){var o=t[r],a=n[o],s=!1;if(a===undefined)for(var u=0;u<i.length;u++)if(o.match(i[u])&&n[i[u]].wildcard){a=n[i[u]],s=!0;break}-1!==i.indexOf(o)||s?e.matchedOffers[o]=a:e.notMatchedOffers[o]=a}return e.matchedOffers&&0<Object.keys(e.matchedOffers).length},{defaultValue:{},autoPopSetting:\"once\"}),i.set(\"isCredited\",function n(e){for(var t in e.matchedOffers)if(\"subscription\"===e.matchedOffers[t].offer_license_type){e.credited=!0;break}},{defaultValue:{},autoPopSetting:\"once\"}),i.register(\"dl_matched\",{defaultValue:{},autoPopSetting:\"once\"},function(){if(-1===document.location.href.indexOf(\"products.office.com/en/tracking\"))return{};var e=i.get(\"buildMatchedState\"),t=i.get(\"isCredited\"),n={matchedOffers:{},notMatchedOffers:{},credited:!1};return e(n,i.get(\"dl_iframe_vals\").dl_sku,i.get(\"tealiumDL\"))&&t(n),n})}),oaSetupProvider.addSetupFunc(\"prepare_tagconfigs\",function(e,a){a.set(\"JSLL_config\",function(e,t){if(\"string\"!=typeof e||e===undefined)return{};\"boolean\"==typeof t&&t!==undefined&&!1!==t||(t=a.get(\"haveEUConsent\"));var n={},i=a.get(\"isDebug\"),r=a.get(\"location\"),o=a.get(\"tealiumDL\",!0);return n.logLevel=i?3:0,n.cookiesToCollect=[\"MSFPC\",\"_mkto_trk\",\"omkt\"],t?(n.ix={},n.ix.a=!0,n.ix.g=!0,n.syncMuid=!0):n.syncMuid=!1,n.coreData={},n.coreData.appId=e,n.coreData.market=null!==a.get(\"llcc\")?a.get(\"llcc\"):\"[LANGLOC]\",n.coreData.pageName=o.page_title?o.page_title:r.pathname,n.coreData.pageType=o.page_type?o.page_type:\"\",n.autoCapture={},n.debounceMS={},n.callback={},e?n:{}},{defaultValue:null,autoPopSetting:\"always\"})}),oaSetupProvider.addSetupFunc(\"prepare_wdg_metadata\",function(l,c){var e=c.get(\"location\")||{};return!!(e.pathname&&(e.pathname.match(/\\/hololens(\\/?|$)/i)||e.pathname.match(/\\/mixed-reality(\\/?|$)/i)))&&(c.register(\"wdgPageName\",{defaultValue:\"homepage\",autoPopSetting:\"always\"},function(){var e,t=c.get(\"location\")||{},n=\"www.microsoft.com\"===t.host?\"prod\":\"staging\";if(t.host.match(/passcraperhost\\.corp\\.microsoft\\.com/i))c.set(\"loc\",\"us\"),c.set(\"llcc\",\"en-us\"),e=\"testpage\";else{var i=t.pathname?t.pathname.toLowerCase().split(\"/\"):[],r=function(e,t){return e?e.toLowerCase().trim():t},o=\"prod\"===n?1:2;if(llcc=i[o],\"homepage\"!==(e=r(i[o+=2],\"homepage\"))){for(o++;o<i.length;o++)e+=\"/\"+i[o];e=r(e).replace(/[\\-_]/g,\" \")}}return e}),c.register(\"getWdgProductInfo\",{defaultValue:null,autoPopSetting:\"once\"},function(){return function(e){var t,n=c.get(\"jquery\"),i=n(e),r={id:null,sku:null,name:null,retailer:null,cta:null};if(i.is(\"A\")){var o=i.is(\"A\")?i[0].pathname:\"\",a=i.is(\"A\")?i[0].search:\"\";o.match(/productID/i)?(t=o.split(\"productID\"),r.id=0<t.length?t[1]:null):a.match(/pid\\=/i)?r.id=l.util.getQueryParam(\"pid\",a):o.match(/\\/store\\/(b|d|config|buy|p)\\//i)&&(t=o.substring(o.indexOf(\"/store\")).split(\"/\"),r.id=4<t.length?t[4]:null,r.sku=5<t.length?t[5]:null),null==r.sku&&a.match(/sid\\=/i)&&(r.sku=l.util.getQueryParam(\"sid\",a))}if(i.attr(\"data-bi-name\")&&(r.cta=n.trim(i.attr(\"data-bi-name\"))),i.attr(\"data-m\")){var s=n.parseJSON(i.attr(\"data-m\")||\"{}\");s&&(null==r.id&&s.prodid&&(r.id=s.prodid),null==r.retailer&&s.prtnm&&(r.retailer=s.prtnm),null==r.cta&&s.cN&&(r.cta=n.trim(s.cN)),null==r.cta&&s.contentName&&(r.cta=n.trim(s.contentName)))}if(null==r.id&&i.attr(\"data-bigid\")&&(r.id=i.attr(\"data-bigid\")),null==r.id&&i.attr(\"data-productid\")&&(r.id=i.attr(\"data-productid\")),null==r.id&&i.attr(\"productbuyxmlid\")&&(r.id=i.attr(\"productbuyxmlid\")),null==r.id&&i.attr(\"ps-sku\")&&(r.id=i.attr(\"ps-sku\")),0<i.parents(\".m-product-placement-item\").length){var u=i.parents(\".m-product-placement-item\").find(\"[itemprop='name']\");0<u.length&&(r.name=n.trim(u.text()))}return i.attr(\"data-name\")&&(r.name=i.attr(\"data-name\")),0<i.parents(\".ps-online-seller-select[data-name]\").length&&(r.name=i.parents(\".ps-online-seller-select[data-name]:first\").attr(\"data-name\")),i.attr(\"data-bi-prtnm\")&&(r.retailer=i.attr(\"data-bi-prtnm\")),null!=r.retailer&&\"\"!=r.retailer||!i.attr(\"data-retailer\")||(r.retailer=i.attr(\"data-retailer\")||\"\"),(null==r.retailer||\"\"==r.retailer)&&0<i.parents(\"[data-retailer]\").length&&(r.retailer=i.parents(\"[data-retailer]:first\").attr(\"data-retailer\")),r}}),!0)}),window.utf_event&&window.utf_event.trigger(\"frameworkLoaded\"),window.utfLoaded=!0;");